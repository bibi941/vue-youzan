{"version":3,"sources":["webpack:///static/js/cart.cec889e040b6af4df531.js","webpack:///./src/modules/js/api.js","webpack:///./src/modules/js/mixin.js","webpack:///./src/pages/cart/cart.js"],"names":["webpackJsonp","2","module","__webpack_exports__","__webpack_require__","url","hotLists","banner","topList","subList","rank","serachList","details","deal","cartAdd","cartRemove","cartMremove","cartReduce","cartList","cartUpdate","addressLists","addressAdd","addressRemove","addressUpdate","addressSetDefault","key","hasOwnProperty","4","mixin","filters","currency","price","92","Object","defineProperty","value","__WEBPACK_IMPORTED_MODULE_0__cart_base_css__","__WEBPACK_IMPORTED_MODULE_1__cart_trade_css__","n","__WEBPACK_IMPORTED_MODULE_2__cart_css__","__WEBPACK_IMPORTED_MODULE_3_vue__","__WEBPACK_IMPORTED_MODULE_4_axios__","__WEBPACK_IMPORTED_MODULE_4_axios___default","__WEBPACK_IMPORTED_MODULE_5_js_mixin_js__","__WEBPACK_IMPORTED_MODULE_6_js_api_js__","__WEBPACK_IMPORTED_MODULE_7_velocity_animate__","__WEBPACK_IMPORTED_MODULE_7_velocity_animate___default","el","data","lists","total","editingShop","editingShopIndex","removePopup","removeData","removeMsg","created","this","getList","computed","allSelected","get","length","every","shop","checked","set","newval","map","goodsList","good","allRemoveSelected","removeChecked","forEach","selectLists","arr","push","number","removeLists","methods","_this","a","post","then","editing","editingMsg","selectGood","attr","selecShop","selectAll","edit","shopIndex","item","index","reduce","id","add","removeConfirm","_this2","_removeData","goodIndex","splice","removeShop","idArray","findIndex","remove","removeList","start","e","startX","changedTouches","clientX","end","endX","left","$refs","mixins","93","exports","95","96"],"mappings":"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","file":"static/js/cart.cec889e040b6af4df531.js","sourcesContent":["webpackJsonp([5],{\n\n/***/ 2:\n/***/ (function(module, __webpack_exports__, __webpack_require__) {\n\n\"use strict\";\n//Rap的mock数据\nvar url = {\n  hotLists: '/index/hotList',\n  banner: '/index/banner',\n  topList: '/category/topList',\n  subList: '/category/subList',\n  rank: '/category/rank',\n  serachList: '/search/list',\n  details: '/goods/details',\n  deal: '/goods/deal',\n  cartAdd: '/cart/add',\n  cartRemove: '/cart/remove',\n  cartMremove: '/cart/mremove',\n  cartReduce: '/cart/reduce',\n  cartList: '/cart/list',\n  cartUpdate: '/cart/update',\n  addressLists: '/address/list',\n  addressAdd: '/address/add',\n  addressRemove: '/address/remove',\n  addressUpdate: '/address/update',\n  addressSetDefault: '/address/setDefault'\n  //开发环境和真是环境切换\n  // let host=\"\"\n};var host = 'http://rapapi.org/mockjsdata/34279';\n\nfor (var key in url) {\n  if (url.hasOwnProperty(key)) {\n    url[key] = host + url[key];\n  }\n}\n\n/* harmony default export */ __webpack_exports__[\"a\"] = (url);\n\n/***/ }),\n\n/***/ 4:\n/***/ (function(module, __webpack_exports__, __webpack_require__) {\n\n\"use strict\";\nvar mixin = {\n  filters: {\n    currency: function currency(price) {\n      return price + '.00';\n    }\n  }\n};\n\n/* harmony default export */ __webpack_exports__[\"a\"] = (mixin);\n\n/***/ }),\n\n/***/ 92:\n/***/ (function(module, __webpack_exports__, __webpack_require__) {\n\n\"use strict\";\nObject.defineProperty(__webpack_exports__, \"__esModule\", { value: true });\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0__cart_base_css__ = __webpack_require__(93);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0__cart_base_css___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_0__cart_base_css__);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1__cart_trade_css__ = __webpack_require__(95);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1__cart_trade_css___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_1__cart_trade_css__);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2__cart_css__ = __webpack_require__(96);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2__cart_css___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_2__cart_css__);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_3_vue__ = __webpack_require__(5);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_4_axios__ = __webpack_require__(9);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_4_axios___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_4_axios__);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_5_js_mixin_js__ = __webpack_require__(4);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_6_js_api_js__ = __webpack_require__(2);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_7_velocity_animate__ = __webpack_require__(58);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_7_velocity_animate___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_7_velocity_animate__);\n\n\n\n\n\n\n\n\n\n\nnew __WEBPACK_IMPORTED_MODULE_3_vue__[\"default\"]({\n  el: '.container',\n  data: {\n    lists: '',\n    total: 0,\n    editingShop: null,\n    editingShopIndex: -1,\n    removePopup: false,\n    removeData: '',\n    removeMsg: ''\n  },\n  created: function created() {\n    this.getList();\n  },\n\n  computed: {\n    allSelected: {\n      get: function get() {\n        if (this.lists && this.lists.length) {\n          return this.lists.every(function (shop) {\n            //每一个店铺被选中，才能让全选高亮\n            return shop.checked;\n          });\n        }\n        return false;\n      },\n      set: function set(newval) {\n        this.lists.map(function (shop) {\n          shop.checked = newval;\n          shop.goodsList.map(function (good) {\n            good.checked = newval;\n          });\n        });\n      }\n    },\n    allRemoveSelected: {\n      get: function get() {\n        if (this.editingShop) {\n          //商铺点选，则商铺高亮\n          return this.editingShop.removeChecked;\n        }\n        return false;\n      },\n      set: function set(newval) {\n        if (this.editingShop) {\n          //商铺全选则商品和全选按钮高亮\n          this.editingShop.removeChecked = newval;\n          this.editingShop.goodsList.forEach(function (good) {\n            good.removeChecked = newval;\n          });\n        }\n      }\n    },\n    selectLists: function selectLists() {\n      if (this.lists && this.lists.length) {\n        var arr = [];\n        var total = 0;\n        this.lists.forEach(function (shop) {\n          shop.goodsList.forEach(function (good) {\n            if (good.checked) {\n              arr.push(good);\n              total += good.price * good.number;\n            }\n          });\n        });\n        this.total = total;\n        return arr;\n      }\n      return [];\n    },\n    removeLists: function removeLists() {\n      //用来判断显示删除和结算按钮\n      if (this.editingShop) {\n        var arr = [];\n        this.editingShop.goodsList.forEach(function (good) {\n          if (good.removeChecked) {\n            arr.push(good);\n          }\n        });\n        return arr;\n      }\n      return [];\n    }\n  },\n  methods: {\n    getList: function getList() {\n      var _this = this;\n\n      __WEBPACK_IMPORTED_MODULE_4_axios___default.a.post(__WEBPACK_IMPORTED_MODULE_6_js_api_js__[\"a\" /* default */].cartList).then(function (data) {\n        var lists = data.data.cartList;\n        lists.map(function (shop) {\n          //商铺默认状态\n          shop.checked = true;\n          shop.editing = false;\n          shop.editingMsg = '编辑';\n          shop.removeChecked = false;\n          shop.goodsList.map(function (good) {\n            //商品默认状态\n            good.checked = true;\n            good.removeChecked = false;\n          });\n        });\n        _this.lists = lists;\n      });\n    },\n    selectGood: function selectGood(shop, good) {\n      var attr = this.editingShop ? 'removeChecked' : 'checked';\n      good[attr] = !good[attr];\n      shop[attr] = shop.goodsList.every(function (good) {\n        return good[attr];\n      });\n    },\n    selecShop: function selecShop(shop) {\n      var attr = this.editingShop ? 'removeChecked' : 'checked';\n      shop[attr] = !shop[attr];\n      shop.goodsList.map(function (good) {\n        //商品全选=店铺选中\n        good[attr] = shop[attr];\n      });\n    },\n    selectAll: function selectAll() {\n      var attr = this.editingShop ? 'allRemoveSelected' : 'allSelected';\n      this[attr] = !this[attr];\n    },\n    edit: function edit(shop, shopIndex) {\n      shop.editing = !shop.editing;\n      shop.editingMsg = shop.editing ? '完成' : '编辑';\n      this.lists.forEach(function (item, index) {\n        //非编辑状态下的其他店铺状态\n        if (shopIndex !== index) {\n          item.editing = false;\n          item.editingMsg = shop.editing ? '' : '编辑';\n        }\n      });\n      //全局数据\n      this.editingShop = shop.editing ? shop : null;\n      this.editingShopIndex = shop.editing ? shopIndex : -1;\n    },\n    reduce: function reduce(good) {\n      if (good.number === 1) return;\n      __WEBPACK_IMPORTED_MODULE_4_axios___default.a.post(__WEBPACK_IMPORTED_MODULE_6_js_api_js__[\"a\" /* default */].cartReduce, {\n        id: good.id,\n        number: 1\n      }).then(function (data) {\n        good.number -= 1;\n      });\n    },\n    add: function add(good) {\n      __WEBPACK_IMPORTED_MODULE_4_axios___default.a.post(__WEBPACK_IMPORTED_MODULE_6_js_api_js__[\"a\" /* default */].cartAdd, {\n        id: good.id,\n        number: 1\n      }).then(function (data) {\n        good.number += 1;\n      });\n    },\n    removeConfirm: function removeConfirm() {\n      var _this2 = this;\n\n      if (this.removeMsg === '确定要删除该商品吗？') {\n        //单个商品删除\n        var _removeData = this.removeData,\n            shop = _removeData.shop,\n            shopIndex = _removeData.shopIndex,\n            good = _removeData.good,\n            goodIndex = _removeData.goodIndex;\n        //异步请求，和数据库确认成功后方可删除\n\n        __WEBPACK_IMPORTED_MODULE_4_axios___default.a.post(__WEBPACK_IMPORTED_MODULE_6_js_api_js__[\"a\" /* default */].cartRemove, {\n          id: good.id\n        }).then(function (data) {\n          shop.goodsList.splice(goodIndex, 1);\n          if (shop.goodsList.length === 0) {\n            _this2.lists.splice(shopIndex, 1);\n            _this2.removeShop();\n          }\n          _this2.removePopup = false;\n          // this.$refs[`goods-${shopIndex}-${goodIndex}`][0].style.left='0px'          \n        });\n      } else {\n        //删除多个商品\n        var idArray = [];\n        this.removeLists.forEach(function (good) {\n          idArray.push(good.id);\n        });\n        __WEBPACK_IMPORTED_MODULE_4_axios___default.a.post(__WEBPACK_IMPORTED_MODULE_6_js_api_js__[\"a\" /* default */].cartMremove, {\n          idArray: idArray\n        }).then(function (data) {\n          var arr = [];\n          _this2.editingShop.goodsList.forEach(function (good) {\n            //每个商品是否在删除列表中\n            var index = _this2.removeLists.findIndex(function (item) {\n              return item.id === good.id;\n            });\n            if (index === -1) {\n              //如果编辑列表中有商品没有被点选删除\n              arr.push(good);\n            }\n          });\n          if (arr.length) {\n            //新的编辑列表就是除开没有被点选删除的剩下的商品\n            _this2.editingShop.goodsList = arr;\n          } else {\n            //店铺下全部商品被选择了\n            _this2.lists.splice(_this2.editingShopIndex, 1);\n            _this2.removeShop();\n          }\n          _this2.removePopup = false;\n        });\n      }\n    },\n    removeShop: function removeShop() {\n      //店铺所有商品被删除完后，删除店铺，恢复初始状态\n      this.editingShop = '', this.editingShopIndex = -1;\n      this.lists.forEach(function (shop) {\n        shop.editing = false;\n        shop.editingMsg = '编辑';\n      });\n    },\n\n    //删除商品\n    remove: function remove(shop, shopIndex, good, goodIndex) {\n      this.removePopup = true;\n      this.removeData = {\n        shop: shop,\n        shopIndex: shopIndex,\n        good: good,\n        goodIndex: goodIndex\n      };\n      this.removeMsg = '确定要删除该商品吗？';\n    },\n    removeList: function removeList() {\n      this.removePopup = true;\n      this.removeMsg = '\\u786E\\u5B9A\\u5C06\\u6240\\u9009 ' + this.removeLists.length + ' \\u4E2A\\u5546\\u54C1\\u5220\\u9664\\uFF1F';\n    },\n    start: function start(e, good) {\n      good.startX = e.changedTouches[0].clientX;\n    },\n    end: function end(e, shopIndex, good, goodIndex) {\n      var endX = e.changedTouches[0].clientX;\n      var left = '0';\n      //左滑\n      if (good.startX - endX > 100) {\n        left = '-60px';\n      }\n      //右滑\n      if (endX - good.startX > 100) {\n        left = '0px';\n      }\n      __WEBPACK_IMPORTED_MODULE_7_velocity_animate___default()(this.$refs['good-' + shopIndex + '-' + goodIndex], {\n        left: left\n      });\n    }\n  },\n  mixins: [__WEBPACK_IMPORTED_MODULE_5_js_mixin_js__[\"a\" /* default */]]\n});\n\n/***/ }),\n\n/***/ 93:\n/***/ (function(module, exports) {\n\n// removed by extract-text-webpack-plugin\n\n/***/ }),\n\n/***/ 95:\n/***/ (function(module, exports) {\n\n// removed by extract-text-webpack-plugin\n\n/***/ }),\n\n/***/ 96:\n/***/ (function(module, exports) {\n\n// removed by extract-text-webpack-plugin\n\n/***/ })\n\n},[92]);\n\n\n// WEBPACK FOOTER //\n// static/js/cart.cec889e040b6af4df531.js","//Rap的mock数据\nlet url = {\n  hotLists: '/index/hotList',\n  banner: '/index/banner',\n  topList: '/category/topList',\n  subList: '/category/subList',\n  rank: '/category/rank',\n  serachList: '/search/list',\n  details: '/goods/details',\n  deal: '/goods/deal',\n  cartAdd: '/cart/add',\n  cartRemove: '/cart/remove',\n  cartMremove: '/cart/mremove',\n  cartReduce: '/cart/reduce',\n  cartList: '/cart/list',\n  cartUpdate: '/cart/update',\n  addressLists: '/address/list',\n  addressAdd: '/address/add',\n  addressRemove: '/address/remove',\n  addressUpdate: '/address/update',\n  addressSetDefault: '/address/setDefault'\n}\n//开发环境和真是环境切换\n// let host=\"\"\nlet host = 'http://rapapi.org/mockjsdata/34279'\n\nfor (let key in url) {\n  if (url.hasOwnProperty(key)) {\n    url[key] = host + url[key]\n  }\n}\n\nexport default url\n\n\n\n// WEBPACK FOOTER //\n// ./src/modules/js/api.js","let mixin = {\n  filters: {\n    currency(price) {\n      return price + '.00'\n    }\n  }\n}\n\nexport default mixin\n\n\n// WEBPACK FOOTER //\n// ./src/modules/js/mixin.js","import './cart_base.css'\nimport './cart_trade.css'\nimport './cart.css'\n\nimport Vue from 'vue'\nimport axios from 'axios'\nimport mixin from 'js/mixin.js'\nimport url from 'js/api.js'\nimport velocity from 'velocity-animate'\n\nnew Vue({\n  el: '.container',\n  data: {\n    lists: '',\n    total: 0,\n    editingShop: null,\n    editingShopIndex: -1,\n    removePopup: false,\n    removeData: '',\n    removeMsg: '',\n  },\n  created() {\n    this.getList()\n  },\n  computed: {\n    allSelected: {\n      get() {\n        if (this.lists && this.lists.length) {\n          return this.lists.every(shop => {\n            //每一个店铺被选中，才能让全选高亮\n            return shop.checked\n          })\n        }\n        return false\n      },\n      set(newval) {\n        this.lists.map(shop => {\n          shop.checked = newval\n          shop.goodsList.map(good => {\n            good.checked = newval\n          })\n        })\n      }\n    },\n    allRemoveSelected: {\n      get() {\n        if (this.editingShop) {\n          //商铺点选，则商铺高亮\n          return this.editingShop.removeChecked\n        }\n        return false\n      },\n      set(newval) {\n        if (this.editingShop) {\n          //商铺全选则商品和全选按钮高亮\n          this.editingShop.removeChecked = newval\n          this.editingShop.goodsList.forEach((good) => {\n            good.removeChecked = newval\n          })\n        }\n      }\n    },\n    selectLists() {\n      if (this.lists && this.lists.length) {\n        let arr = []\n        let total = 0\n        this.lists.forEach(shop => {\n          shop.goodsList.forEach(good => {\n            if (good.checked) {\n              arr.push(good)\n              total += good.price * good.number\n            }\n          })\n        })\n        this.total = total\n        return arr\n      }\n      return []\n    },\n    removeLists() {\n      //用来判断显示删除和结算按钮\n      if (this.editingShop) {\n        let arr = []\n        this.editingShop.goodsList.forEach((good) => {\n          if (good.removeChecked) {\n            arr.push(good)\n          }\n        })\n        return arr\n      }\n      return []\n    }\n  },\n  methods: {\n    getList() {\n      axios.post(url.cartList).then(data => {\n        let lists = data.data.cartList\n        lists.map(shop => {\n          //商铺默认状态\n          shop.checked = true\n          shop.editing = false\n          shop.editingMsg = '编辑'\n          shop.removeChecked = false\n          shop.goodsList.map(good => {\n            //商品默认状态\n            good.checked = true\n            good.removeChecked = false\n          })\n        })\n        this.lists = lists\n      })\n    },\n    selectGood(shop, good) {\n      let attr = this.editingShop ? 'removeChecked' : 'checked'\n      good[attr] = !good[attr]\n      shop[attr] = shop.goodsList.every(good => {\n        return good[attr]\n      })\n    },\n    selecShop(shop) {\n      let attr = this.editingShop ? 'removeChecked' : 'checked'\n      shop[attr] = !shop[attr]\n      shop.goodsList.map(good => {\n        //商品全选=店铺选中\n        good[attr] = shop[attr]\n      })\n    },\n    selectAll() {\n      let attr = this.editingShop ? 'allRemoveSelected' : 'allSelected'\n      this[attr] = !this[attr]\n    },\n    edit(shop, shopIndex) {\n      shop.editing = !shop.editing\n      shop.editingMsg = shop.editing ? '完成' : '编辑'\n      this.lists.forEach((item, index) => {\n        //非编辑状态下的其他店铺状态\n        if (shopIndex !== index) {\n          item.editing = false\n          item.editingMsg = shop.editing ? '' : '编辑'\n        }\n      })\n      //全局数据\n      this.editingShop = shop.editing ? shop : null\n      this.editingShopIndex = shop.editing ? shopIndex : -1\n    },\n    reduce(good) {\n      if (good.number === 1)\n        return\n      axios.post(url.cartReduce, {\n        id: good.id,\n        number: 1\n      }).then(data => {\n        good.number -= 1\n      })\n    },\n    add(good) {\n      axios.post(url.cartAdd, {\n        id: good.id,\n        number: 1\n      }).then((data) => {\n        good.number += 1\n      })\n    },\n    removeConfirm() {\n      if (this.removeMsg === '确定要删除该商品吗？') {\n        //单个商品删除\n        let {\n          shop,\n          shopIndex,\n          good,\n          goodIndex\n        } = this.removeData\n        //异步请求，和数据库确认成功后方可删除\n        axios.post(url.cartRemove, {\n          id: good.id\n        }).then(data => {\n          shop.goodsList.splice(goodIndex, 1)\n          if (shop.goodsList.length === 0) {\n            this.lists.splice(shopIndex, 1)\n            this.removeShop()\n          }\n          this.removePopup = false\n          // this.$refs[`goods-${shopIndex}-${goodIndex}`][0].style.left='0px'          \n        })\n      } else {\n        //删除多个商品\n        let idArray = []\n        this.removeLists.forEach(good => {\n          idArray.push(good.id)\n        })\n        axios.post(url.cartMremove, {\n          idArray\n        }).then(data => {\n          let arr = []\n          this.editingShop.goodsList.forEach(good => {\n            //每个商品是否在删除列表中\n            let index = this.removeLists.findIndex(item => {\n              return item.id === good.id\n            })\n            if (index === -1) {\n              //如果编辑列表中有商品没有被点选删除\n              arr.push(good)\n            }\n          })\n          if (arr.length) {\n            //新的编辑列表就是除开没有被点选删除的剩下的商品\n            this.editingShop.goodsList = arr\n          } else {\n            //店铺下全部商品被选择了\n            this.lists.splice(this.editingShopIndex, 1)\n            this.removeShop()\n          }\n          this.removePopup = false\n        })\n      }\n    },\n    removeShop() {\n      //店铺所有商品被删除完后，删除店铺，恢复初始状态\n      this.editingShop = '',\n        this.editingShopIndex = -1\n      this.lists.forEach(shop => {\n        shop.editing = false\n        shop.editingMsg = '编辑'\n      })\n    },\n    //删除商品\n    remove(shop, shopIndex, good, goodIndex) {\n      this.removePopup = true\n      this.removeData = {\n        shop,\n        shopIndex,\n        good,\n        goodIndex\n      }\n      this.removeMsg = '确定要删除该商品吗？'\n\n    },\n    removeList() {\n      this.removePopup = true\n      this.removeMsg = `确定将所选 ${this.removeLists.length} 个商品删除？`\n    },\n    start(e, good) {\n      good.startX = e.changedTouches[0].clientX\n\n    },\n    end(e, shopIndex, good, goodIndex) {\n      let endX = e.changedTouches[0].clientX\n      let left = '0'\n      //左滑\n      if (good.startX - endX > 100) {\n        left = '-60px'\n      }\n      //右滑\n      if (endX - good.startX > 100) {\n        left = '0px'\n      }\n      velocity(this.$refs[`good-${shopIndex}-${goodIndex}`], {\n        left: left\n      })\n    },\n  },\n  mixins: [mixin]\n})\n\n\n\n// WEBPACK FOOTER //\n// ./src/pages/cart/cart.js"],"sourceRoot":""}